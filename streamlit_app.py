import streamlit as st
import requests

st.title("ğŸš— êµí†µì‚¬ê³  ìœ„í—˜ ì˜ˆì¸¡ ì„œë¹„ìŠ¤")

st.write("ìœ„ì¹˜ì™€ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ì‚¬ê³  ìœ„í—˜ë„ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤.")

# ------------------------
# ì…ë ¥ UI
# ------------------------

weekday = st.selectbox("ìš”ì¼", ["ì›”ìš”ì¼","í™”ìš”ì¼","ìˆ˜ìš”ì¼","ëª©ìš”ì¼","ê¸ˆìš”ì¼","í† ìš”ì¼","ì¼ìš”ì¼"])
ë°œìƒì§€ì‹œë„ = st.text_input("ì‹œë„", "ì„œìš¸")
ì‚¬ê³ ìœ í˜• = st.text_input("ì‚¬ê³ ìœ í˜•", "ì°¨ëŒ€ì‚¬ëŒ")
ë„ë¡œí˜•íƒœ = st.text_input("ë„ë¡œí˜•íƒœ", "ë‹¨ì¼ë¡œ")
ê°€í•´ì = st.text_input("ê°€í•´ì", "ìŠ¹ìš©ì°¨")
í”¼í•´ì = st.text_input("í”¼í•´ì", "ë³´í–‰ì")
ì£¼ì•¼ = st.selectbox("ì£¼ì•¼", ["ì£¼","ì•¼"])

ë°œìƒë…„ = st.number_input("ë°œìƒë…„", value=2023)
ë°œìƒì›” = st.number_input("ë°œìƒì›”", value=5)
ë°œìƒì¼ = st.number_input("ë°œìƒì¼", value=12)
ë°œìƒì‹œ = st.number_input("ë°œìƒì‹œ", value=14)

ìœ„ë„ = st.number_input("ìœ„ë„", value=37.4979)
ê²½ë„ = st.number_input("ê²½ë„", value=127.0276)

ì‚¬ìƒììˆ˜ = st.number_input("ì‚¬ìƒììˆ˜", value=0.3)

# ------------------------
# ë²„íŠ¼
# ------------------------

if st.button("ì˜ˆì¸¡í•˜ê¸° ğŸš€"):

    url = "http://127.0.0.1:8000/predict"

    payload = {
        "ìš”ì¼": weekday,
        "ë°œìƒì§€ì‹œë„": ë°œìƒì§€ì‹œë„,
        "ì‚¬ê³ ìœ í˜•_ëŒ€ë¶„ë¥˜": ì‚¬ê³ ìœ í˜•,
        "ë„ë¡œí˜•íƒœ_ëŒ€ë¶„ë¥˜": ë„ë¡œí˜•íƒœ,
        "ê°€í•´ì_ë‹¹ì‚¬ìì¢…ë³„": ê°€í•´ì,
        "í”¼í•´ì_ë‹¹ì‚¬ìì¢…ë³„": í”¼í•´ì,
        "ì£¼ì•¼": ì£¼ì•¼,
        "ë°œìƒë…„": ë°œìƒë…„,
        "ë°œìƒì›”": ë°œìƒì›”,
        "ë°œìƒì¼": ë°œìƒì¼,
        "ë°œìƒì‹œ": ë°œìƒì‹œ,
        "ê²½ë„": ê²½ë„,
        "ìœ„ë„": ìœ„ë„,
        "ì‚¬ìƒììˆ˜": ì‚¬ìƒììˆ˜
    }

    try:
        response = requests.post(url, json=payload)

        if response.status_code == 200:
            result = response.json()
            st.success(f"ğŸš¨ ì˜ˆì¸¡ ì‚¬ê³  ê±´ìˆ˜: {result['predicted_ë°˜ê²½500mì‚¬ê³ ê±´ìˆ˜']:.2f}")

            st.write("ğŸ“Š ì£¼ë³€ í™˜ê²½")
            st.json(result["used_features"])
        else:
            st.error("API ì˜¤ë¥˜ ë°œìƒ")

    except Exception as e:
        st.error(f"ì„œë²„ ì—°ê²° ì‹¤íŒ¨: {e}")